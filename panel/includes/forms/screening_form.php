<form onsubmit="preventDefault();" id="formScreening">
    <h1 style="text-align: center">Patient Screening Form</h1>
    <hr>
    <div class="row form-bottom-line">
        <div class="col-xl-6 col-sm-12">
            <div class="form-group">
                <label for="selectFeverHistory">Hotness of body</label>
                <select required class="form-select" name="selectFeverHistory" id="selectFeverHistory">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectChills">Chills</label>
                <select required class="form-select" name="selectChills" id="selectChills">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectGeneralWeakness">General weakness*</label>
                <select required class="form-select" name="selectGeneralWeakness" id="selectGeneralWeakness">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectCough">Cough</label>
                <select required class="form-select" name="selectCough" id="selectCough">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectSoreThroat">Sore Throat</label>
                <select required class="form-select" name="selectSoreThroat" id="selectSoreThroat">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectRunnyNose">Runny Nose</label>
                <select required class="form-select" name="selectRunnyNose" id="selectRunnyNose">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectWeightLoss">Unintended Weight loss</label>
                <select required class="form-select" name="selectWeightLoss" id="selectWeightLoss">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectIrritability">Irritability/Confusion</label>
                <select required class="form-select" name="selectIrritability" id="selectIrritability">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectConfusion">Irritability/Confusion</label>
                <select required class="form-select" name="selectConfusion" id="selectConfusion">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectNausea">Nausea</label>
                <select required class="form-select" name="selectNausea" id="selectNausea">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectVomiting">Vomiting</label>
                <select required class="form-select" name="selectVomiting" id="selectVomiting">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
        </div>
        <div class="col-xl-6 col-sm-12">
            <div class="form-group">
                <label for="selectNightSweats">Night sweats *</label>
                <select required class="form-select" name="selectNightSweats" id="selectNightSweats">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectLossOfTaste">Loss of taste(NEW)</label>
                <select required class="form-select" name="selectLossOfTaste" id="selectLossOfTaste">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectLossOfSmell">Loss of smell(NEW)</label>
                <select required class="form-select" name="selectLossOfSmell" id="selectLossOfSmell">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectBreathingDifficulty">Difficulty in breathing*</label>
                <select required class="form-select" name="selectBreathingDifficulty" id="selectBreathingDifficulty">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectDiarrhoea">Diarrhoea</label>
                <select required class="form-select" name="selectDiarrhoea" id="selectDiarrhoea">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectHeadache">Headache</label>
                <select required class="form-select" name="selectHeadache" id="selectHeadache">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectAbdominalPain">Abdominal Pain</label>
                <select required class="form-select" name="selectAbdominalPain" id="selectAbdominalPain">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectChestPain">Chest Pain</label>
                <select required class="form-select" name="selectChestPain" id="selectChestPain">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectJointPain">Joint Pain</label>
                <select required class="form-select" name="selectJointPain" id="selectJointPain">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="selectMusclePain">Muscle Pain</label>
                <select required class="form-select" name="selectMusclePain" id="selectMusclePain">
                    <option hidden value="">Select</option>
                    <option value="Yes">Yes</option>
                    <option value="No">No</option>
                </select>
            </div>
        </div>

    </div>
    
    <hr>
    <button id="btnSaveForm" type="button" class="btn btn-success submit mt-5 mb-5" onclick="savePatientScreening()"><i class="fa fa-caret-right" aria-hidden="true"></i> Submit Form</button>

</form>

<script>
    var patient_id = null
    $(document).ready(function() {
        if (localStorage.getItem('checkedInPatient') != null) {
            let patient = JSON.parse(localStorage.getItem('checkedInPatient'))
            patient_id = patient.id
        } else {
            document.getElementById('btnSaveForm').setAttribute('disabled', '')
        }
    })

    function savePatientScreening() {
        if (patient_id === null) return;
        let fever_history = $('#selectFeverHistory').val(),
            chills = $('#selectChills').val(),
            general_weakness = $('#selectGeneralWeakness').val(),
            cough = $('#selectCough').val(),
            sore_throat = $('#selectSoreThroat').val(),
            runny_nose = $('#selectRunnyNose').val(),
            weight_loss = $('#selectWeightLoss').val(),
            night_sweats = $('#selectNightSweats').val(),
            loss_of_taste = $('#selectLossOfTaste').val(),
            loss_of_smell = $('#selectLossOfSmell').val(),
            breathing_difficulty = $('#selectBreathingDifficulty').val(),
            diarrhoea = $('#selectDiarrhoea').val(),
            headache = $('#selectHeadache').val(),
            irritability = $('#selectIrritability').val(),
            confusion = $('#selectConfusion').val(),
            nausea = $('#selectNausea').val(),
            abdominal_pain = $('#selectAbdominalPain').val(),
            chest_pain = $('#selectChestPain').val(),
            joint_pain = $('#selectJointPain').val(),
            muscle_pain = $('#selectMusclePain').val(),
            errorMsg = '';

        if(fever_history === '') errorMsg += 'Enter a valid value for fever. \n '
        if(chills === '') errorMsg += 'Enter a valid value for fever. \n '
        if(general_weakness === '') errorMsg += 'Enter a valid value for general weakness. \n '
        if(cough === '') errorMsg += 'Enter a valid value for cough. \n '
        if(sore_throat === '') errorMsg += 'Enter a valid value for sore throat. \n '
        if(runny_nose === '') errorMsg += 'Enter a valid value for runny nose. \n '
        if(weight_loss === '') errorMsg += 'Enter a valid value for weight loss. \n '
        if(night_sweats === '') errorMsg += 'Enter a valid value for night sweats. \n '
        if(loss_of_taste === '') errorMsg += 'Enter a valid value for loss of taste. \n '
        if(loss_of_smell === '') errorMsg += 'Enter a valid value for loss of smell. \n '
        if(breathing_difficulty === '') errorMsg += 'Enter a valid value for breathing difficulty. \n '
        if(diarrhoea === '') errorMsg += 'Enter a valid value for diarrhoea. \n '
        if(headache === '') errorMsg += 'Enter a valid value for headache. \n '
        if(irritability === '') errorMsg += 'Enter a valid value for irritability. \n '
        if(confusion === '') errorMsg += 'Enter a valid value for confusion. \n '
        if(abdominal_pain === '') errorMsg += 'Enter a valid value for abdominal pain. \n '
        if(chest_pain === '') errorMsg += 'Enter a valid value for chest pain. \n '
        if(joint_pain === '') errorMsg += 'Enter a valid value for joint pain. \n '
        if(muscle_pain === '') errorMsg += 'Enter a valid value for muscle pain. \n '
        if (errorMsg !== ''){
            toastr.error(errorMsg)
            return
        }

        let formData = new FormData()
        formData.append('patient_id', patient_id)
        formData.append('fever_history', fever_history)
        formData.append('chills', chills)
        formData.append('general_weakness', general_weakness)
        formData.append('cough', cough)
        formData.append('sore_throat', sore_throat)
        formData.append('runny_nose', runny_nose)
        formData.append('weight_loss', weight_loss)
        formData.append('night_sweats', night_sweats)
        formData.append('loss_of_taste', loss_of_taste)
        formData.append('loss_of_smell', loss_of_smell)
        formData.append('breathing_difficulty', breathing_difficulty)
        formData.append('diarrhoea', diarrhoea)
        formData.append('headache', headache)
        formData.append('irritability', irritability)
        formData.append('confusion', confusion)
        formData.append('nausea', nausea)
        formData.append('abdominal_pain', abdominal_pain)
        formData.append('chest_pain', chest_pain)
        formData.append('joint_pain', joint_pain)
        formData.append('muscle_pain', muscle_pain)

        $.ajax({
            type: 'POST',
            url: "saveScreening",
            data: formData,
            cache: false,
            processData: false,
            contentType: false,
            success: response => {
                toastr.success("Form saved successfully");
                document.getElementById('formScreening').reset()
            },
            error: err => {
                toastr.error("An error occurred : " + err.message)
            }
        })
    }
</script>